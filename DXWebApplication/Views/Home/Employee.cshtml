@{
    ViewBag.Title = "Employee";
}

<script>


    function OnBeginCallback(s, e) {

        if (e.command === "STARTEDIT") {
            var key = s.GetRowKey(s.GetFocusedRowIndex());
            e.customArgs['ACC_EMP_ID'] = key;
        }
        e.customArgs['Command'] = e.command;
    }



    var rowIndex = 0;
    function SalaryAmountGridView_OnBatchEditStartEditing(s, e) {
        rowIndex = e.visibleIndex;
        var salaryamount = SalaryAmountGridView.batchEditApi.GetCellValue(rowIndex, "HRS_SAL_SalaryAmount", false);
        var startDate = SalaryAmountGridView.batchEditApi.GetCellValue(rowIndex, "HRS_SAL_StartDate", false);
        if (e.focusedColumn.fieldName == "HRS_SAL_StartDate") {
            if (salaryamount == null)
                e.cancel = true;
        }
        if (e.focusedColumn.fieldName == "HRS_SAL_EndDate") {
            if (salaryamount == null || startDate == null)
                e.cancel = true;
        }

    }

    function SalaryAmountGridView_OnBatchEditRowInserting(s, e) {
        var arr = SalaryAmountGridView.batchEditApi.GetInsertedRowIndices();
        if (arr.length != 0)
            e.cancel = true;
    }

    function HRS_SAL_SalaryAmount_OnValueChange(s, e) {

        var salaryamount = s.GetValue();
        var startDate = s.GetValue();

        if (startDate == null || startDate == "") {
            SalaryAmountGridView.batchEditApi.SetCellValue(rowIndex, "HRS_SAL_StartDate", salaryamount);
        }
    }

    function OnEndCallback (s,e) {

            if (s.cpViewError != null && s.cpViewError.length > 0) {
                var errorMessage = "Validation errors:\n";
                s.cpViewError.forEach(function (error) {
                    errorMessage += error + "\n";
                });
                alert(errorMessage);
            }

    }

//    function employeeEditForm_SavebtnClick(s, e) {
////validation
//        else {
//            employeeGridView.UpdateEdit();
//        }
//    }



     function OnToolbarItemClick(s, e) {

         if (e.item.name == "employeeReport")
             window.location.href = "@Url.Action("ViewEmpReport", "Home"/*, new { id = "id" }*/)";

         if (e.item.name == "salaryReport")
             window.location.href = "@Url.Action("ViewSalReport", "Home"/*, new { id = "id" }*/)";

         if (e.item.name === "showPopupButton")
             popupControl.Show();


 }


</script>

<main>
    <form class="row" aria-labelledby="aspnetTitle">
        <h1 id="title">Employee</h1>


        @Html.Action("PartialEmpGridView")
    </form>
</main>

@Html.DevExpress().PopupControl(settings =>
{
    settings.Name = "popupControl";
    settings.PopupElementID = "button";
    settings.PopupAction = PopupAction.MouseOver;
    settings.ShowOnPageLoad = false;
    settings.Width = 260;
    settings.ShowFooter = true;
    settings.FooterText = "Footer text";
    settings.HeaderText = "Header";
    settings.SetContent(() =>
    {
        ViewContext.Writer.Write("<div>Window content</div>");
    });
}).GetHtml()
